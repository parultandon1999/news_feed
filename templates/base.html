<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Security Intelligence Platform{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}?v=12.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@500;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body class="sidebar-layout">
    <!-- Sophisticated Sidebar -->
    <aside class="app-sidebar">
        <div class="sidebar-header">
            <a href="/" class="sidebar-logo">
                <div class="logo-box">
                    <i data-lucide="shield-check" style="width: 18px; height: 18px;"></i>
                </div>
                <div class="logo-text">SECINTEL</div>
            </a>
        </div>
        
        <nav class="sidebar-nav">
            <a href="/" class="sidebar-nav-link {% if request.endpoint == 'dashboard' %}active{% endif %}">
                <i data-lucide="layout-dashboard" style="width: 18px;"></i>
                <span>Intelligence</span>
            </a>
            <a href="/news" class="sidebar-nav-link {% if request.endpoint == 'news' %}active{% endif %}">
                <i data-lucide="newspaper" style="width: 18px;"></i>
                <span>News Monitor</span>
            </a>
            <a href="/cve" class="sidebar-nav-link {% if request.endpoint == 'cve' %}active{% endif %}">
                <i data-lucide="shield-alert" style="width: 18px;"></i>
                <span>Vulnerabilities</span>
            </a>
            <a href="/ransomware" class="sidebar-nav-link {% if request.endpoint == 'ransomware' %}active{% endif %}">
                <i data-lucide="lock" style="width: 18px;"></i>
                <span>Ransomware</span>
            </a>
            <a href="/government" class="sidebar-nav-link {% if request.endpoint == 'government' %}active{% endif %}">
                <i data-lucide="building-2" style="width: 18px;"></i>
                <span>Advisories</span>
            </a>
            <a href="/tasks" class="sidebar-nav-link {% if request.endpoint == 'tasks' %}active{% endif %}">
                <i data-lucide="list-checks" style="width: 18px;"></i>
                <span>Operations</span>
            </a>
            <a href="/settings" class="sidebar-nav-link {% if request.endpoint == 'settings' %}active{% endif %}">
                <i data-lucide="settings-2" style="width: 18px;"></i>
                <span>System</span>
            </a>
        </nav>
        
        <div style="padding: 24px; border-top: 1px solid var(--border);">
            <div id="themeToggle" style="display: flex; align-items: center; gap: 12px; cursor: pointer; color: var(--text-muted); font-size: 12px; font-weight: 600;">
                <i data-lucide="moon" style="width: 16px;"></i>
                <span>Switch Profile</span>
            </div>
        </div>
    </aside>

    <!-- Content Area -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Notification System -->
    <div id="notificationContainer" style="position: fixed; top: 32px; right: 32px; z-index: 10000; display: flex; flex-direction: column; gap: 12px;"></div>

    <script>
    // Initialize Icons
    lucide.createIcons();

    // Notification Engine
    function showNotification(message, type = 'info') {
        const container = document.getElementById('notificationContainer');
        const note = document.createElement('div');
        note.style.background = 'var(--bg-card)';
        note.style.border = '1px solid var(--border)';
        note.style.padding = '12px 20px';
        note.style.borderRadius = '8px';
        note.style.color = 'var(--text-primary)';
        note.style.fontSize = '13px';
        note.style.fontWeight = '600';
        note.style.boxShadow = '0 10px 30px rgba(0,0,0,0.3)';
        note.style.borderLeft = `4px solid ${type === 'error' ? 'var(--severity-critical)' : 'var(--accent-primary)'}`;
        note.textContent = message;
        
        container.appendChild(note);
        setTimeout(() => {
            note.style.opacity = '0';
            setTimeout(() => note.remove(), 500);
        }, 4000);
    }

    // Theme Logic
    const themeToggle = document.getElementById('themeToggle');
    themeToggle.addEventListener('click', () => {
        const html = document.documentElement;
        const current = html.getAttribute('data-theme');
        const next = current === 'dark' ? 'light' : 'dark';
        html.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
    });

    if (localStorage.getItem('theme')) {
        document.documentElement.setAttribute('data-theme', localStorage.getItem('theme'));
    }
    </script>
</body>
</html>
